#---------------------------------------------------#
# Clash 配置文件 - 全代理模式，防DNS泄露
# 配置文件需要放置在 $HOME/.config/clash/config.yml
# 或者运行目录下的config.yml
#---------------------------------------------------#

# ================ 端口配置 ================
# 混合端口 - HTTP和SOCKS5用一个端口（推荐使用）
mixed-port: 7890

# HTTP 代理端口（如果使用mixed-port可以注释掉）
# port: 7890

# SOCKS5 代理端口
socks-port: 7891

# Linux 和 macOS 的 redir 代理端口（透明代理，如需使用请取消注释）
# redir-port: 7892

# ================ 网络配置 ================
# 允许局域网连接（可用来共享代理给其他设备）
allow-lan: true

# 绑定地址配置（仅在allow-lan为true时生效）
# "*": 绑定所有IP地址（局域网内所有设备都可连接）
# "192.168.1.100": 绑定单个IPv4地址
# "[::1]": 绑定单个IPv6地址
bind-address: "*"

# 启用IPv6支持
ipv6: true

# ================ 运行模式 ================
# 规则模式：
# - rule: 根据规则分流（推荐）
# - global: 全局代理（所有流量走代理）
# - direct: 全局直连（所有流量直连）
# - script: 脚本模式
# mode: rule  # 这里注释掉，让规则文件控制模式

# ================ 日志配置 ================
# 日志级别：silent(无日志) / error / warning / info / debug
# 建议使用info级别，便于调试问题
log-level: info

# ================ API配置 ================
# Clash RESTful API地址（用于网页控制面板）
external-controller: '127.0.0.1:9090'

# 网页控制面板静态资源目录
# 常用面板：
# - yacd: https://github.com/haishanh/yacd
# - Razord: http://clash.razord.top/#/proxies
# - 访问地址: http://127.0.0.1:9090/ui/#/
# external-ui: dashboard

# API访问密码（可选，建议设置）
# secret: "your_password_here"

# ================ 实验性功能 ================
experimental:
  # 忽略DNS解析失败（防止因DNS问题导致连接中断）
  ignore-resolve-fail: true
  # 指定出站网络接口（可选）
  # interface-name: en0

# ================ 认证配置 ================
# 本地SOCKS5/HTTP(S)服务认证（可选）
# authentication:
#   - "username1:password1"
#   - "username2:password2"

# ================ Hosts配置 ================
# 静态域名解析（在fake-ip模式下不生效）
# hosts:
#   '*.example.com': 127.0.0.1
#   'test.example.com': '::1'

# ================ DNS配置（已禁用，防泄露） ================
# 注意：为了防止DNS泄露，这里将DNS配置全部注释掉
# 所有DNS查询将通过代理服务器进行，确保不会泄露真实IP

# dns:
#   enable: true                    # 是否启用DNS
#   ipv6: false                     # 是否解析IPv6
#   listen: 0.0.0.0:53             # DNS监听地址
#   enhanced-mode: redir-host       # DNS模式：redir-host(真实IP) / fake-ip(虚假IP)
#   fake-ip-range: 198.18.0.1/16    # fake-ip地址段
#   
#   # 国内DNS服务器（速度快但可能被污染）
#   nameserver:
#     - 223.5.5.5                   # 阿里DNS
#     - 180.76.76.76                # 百度DNS  
#     - 119.29.29.29                # 腾讯DNS
#     - 114.114.114.114             # 114DNS
#     
#   # 国外DNS服务器（用于解析国外域名，防污染）
#   fallback:
#     - 8.8.8.8                     # 谷歌DNS
#     - 1.1.1.1                     # Cloudflare DNS
#     - tls://dns.google:853        # 谷歌DoT DNS
#     - https://dns.google/dns-query # 谷歌DoH DNS

# ================ CFW专用配置 ================
# Clash for Windows 延迟测试配置
cfw-latency-timeout: 3000                          # 延迟测试超时时间(毫秒)
cfw-latency-url: http://www.gstatic.com/generate_204 # 延迟测试URL

# ================ 连接管理 ================
# 切换代理/配置/模式时的连接处理策略
cfw-conn-break-strategy:
  proxy: none     # 切换代理时：none(不断开) / chain(断开链式连接) / all(断开所有)
  profile: true   # 切换配置时：true(断开) / false(不断开)  
  mode: false     # 切换模式时：true(断开) / false(不断开)

# ================ 界面配置 ================
# 自定义节点排序方式
# - default: 按配置文件定义顺序
# - latency: 按延迟升序排列  
# - alphabet: 按节点名称字母排序
cfw-proxies-order: default

# 自定义字体（可选）
# cfw-font-family: "Microsoft YaHei"

# 自定义托盘图标（可选）
# cfw-tray-icon:
#   default: ./icon_default.png
#   system-proxy-on: ./icon_proxy.png

# ================ 子进程配置 ================
# 启动其他应用程序（可选）
# cfw-child-process:
#   # 示例：启动订阅转换程序
#   - command: "subconverter.exe"
#     args: ["-cfw", "-f", "config.yml"]
#     options:
#       cwd: "subconverter"
#       detached: true
#       windowsHide: true

# ================ 代理和规则配置 ================
# 注意：以下配置会被外部规则文件覆盖
# 实际的代理节点和规则由订阅链接提供

# 示例代理配置（实际使用时会被订阅覆盖）
# proxies:
#   - name: "示例节点"
#     type: shadowsocks
#     server: example.com
#     port: 443

# 示例代理组配置（实际使用时会被订阅覆盖）  
# proxy-groups:
#   - name: "手动选择"
#     type: select
#     proxies: ["示例节点"]

# 示例规则配置（实际使用时会被订阅覆盖）
# rules:
#   - DOMAIN-SUFFIX,google.com,代理组名
#   - MATCH,DIRECT

# ================ 重要说明 ================
# 1. 防DNS泄露设置：
#    - DNS配置已全部注释，所有DNS查询通过代理
#    - 确保不会暴露真实IP地址
#
# 2. 全代理模式：
#    - 除内网地址外，所有流量都走代理
#    - 不会有流量直连到国内服务器
#
# 3. 配置覆盖：
#    - 实际的节点、代理组、规则由外部文件提供
#    - 本文件主要定义基础网络参数

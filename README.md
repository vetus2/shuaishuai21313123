# OpenClash 完全隐匿设置指南

## 🎯 完全隐匿目标

- ✅ **所有流量走代理**：包括国内网站
- ✅ **DNS完全不泄露**：所有DNS查询通过代理  
- ✅ **无任何直连**：彻底隐藏真实IP和位置
- ✅ **局域网正常**：内网功能不受影响

## ⚙️ OpenClash设置步骤

### 第一步：全局设置

进入 **OpenClash → 全局设置**

#### 1.1 模式设置
- **运行模式**：`Fake-IP（混合）`
- **启用 Meta 内核**：✅ 开启
- **启用 UDP 转发**：✅ 开启

#### 1.2 流量控制（关键差异！）
- **绕过中国大陆**：❌ **关闭**（这是关键！）
- **仅代理命中规则流量**：❌ 关闭
- **禁止 Dnsmasq 缓存 DNS**：✅ 开启

### 第二步：DNS设置（完全隐匿核心）

进入 **OpenClash → DNS设置**

#### 2.1 基础DNS设置
- **自定义上游DNS服务器**：✅ 启用
- **追加上游DNS**：❌ **禁用**（关键！）
- **禁用IPv6类型DNS解析**：✅ 开启

#### 2.2 NameServer设置
**重要：禁用所有NameServer！**
- 将所有NameServer都设为禁用状态
- 这样可以避免任何本地DNS查询

#### 2.3 Fallback设置（唯一DNS来源）
**启用所有Fallback服务器**：
```
https://1.1.1.1/dns-query                    ✅ 启用  # Cloudflare DoH
https://8.8.8.8/dns-query                    ✅ 启用  # Google DoH
tls://1.1.1.1:853                           ✅ 启用  # Cloudflare DoT
tls://8.8.4.4:853                           ✅ 启用  # Google DoT
https://doh.opendns.com/dns-query            ✅ 启用  # OpenDNS DoH
https://doh.familyshield.opendns.com/dns-query ✅ 启用  # OpenDNS FamilyShield DoH
208.67.222.222                              ✅ 启用  # OpenDNS 主服务器
208.67.220.220                              ✅ 启用  # OpenDNS 备用服务器
https://dns.quad9.net/dns-query              ✅ 启用  # Quad9 DoH
```

**OpenDNS服务器说明**：
- **208.67.222.222 / 208.67.220.220**：OpenDNS标准服务器，无过滤
- **FamilyShield (doh.familyshield.opendns.com)**：家庭安全版，过滤成人内容
- **标准DoH (doh.opendns.com)**：OpenDNS的DoH版本，支持HTTPS加密

#### 2.4 Fallback过滤器（关键设置）
- **启用 GeoIP Dat 版数据库**：❌ **禁用**
- **不设置任何过滤条件**

这样所有域名都会使用Fallback DNS（通过代理）！

### 第三步：订阅转换设置

#### 3.1 使用完全隐匿模板
上传我提供的完全隐匿配置到你的GitHub，然后：

```ini
clash_rule_base=你的完全隐匿配置文件链接
```

#### 3.2 关键规则差异
- **国内网站**：也走代理（GEOSITE,CN → 🇨🇳 国内代理）
- **国内IP**：也走代理（GEOIP,CN → 🇨🇳 国内代理）
- **FINAL规则**：走代理（🌍 全球代理）

### 第四步：验证设置

#### 4.1 OpenClash状态检查
在OpenClash运行状态页面确认：
- ✅ TUN模式已启用
- ✅ fake-ip模式工作正常
- ✅ 绕过大陆功能已关闭

#### 4.2 控制面板检查
打开Clash控制面板，确认：
- 🇨🇳 国内代理：选择合适的节点
- 🌍 全球代理：选择合适的节点  
- 所有策略组都有节点选择

## 🔍 完全隐匿验证

### 1. DNS泄露检测
访问：https://ipleak.net/

**期望结果**：
- ✅ 显示代理服务器IP（不是真实IP）
- ✅ DNS服务器显示代理位置（如美国、新加坡等）
- ❌ 完全没有中国DNS出现
- ❌ 完全没有真实IP/ISP信息

### 2. 国内网站测试
访问：baidu.com、taobao.com

**期望结果**：
- ✅ 网站正常打开
- ✅ 但是通过代理访问（可能稍慢）
- ✅ 在Clash控制面板日志中看到走了代理

### 3. IP地址检查
访问：https://whatismyipaddress.com/

**期望结果**：
- ✅ 显示代理服务器IP
- ✅ 地理位置为代理服务器位置
- ❌ 完全没有真实位置信息

### 4. 完整隐私检查
访问：https://whoer.net/

**期望结果**：
- ✅ 所有项目都显示代理信息
- ✅ DNS、IP、时区等都是代理位置
- ❌ 没有任何真实信息泄露

## ⚠️ 完全隐匿注意事项

### 1. 性能影响
- 🐌 **所有流量都慢**：连国内网站都走代理
- 🐌 **DNS解析慢**：所有DNS都通过代理
- 💰 **流量消耗大**：所有流量都走节点

### 2. 使用建议
- 🎯 **选择低延迟节点**：减少访问延迟
- 🎯 **选择大流量套餐**：避免流量不够
- 🎯 **准备多个节点**：避免单点故障

### 3. 可能的问题
- 🚫 **银行网站**：可能检测到异常IP
- 🚫 **某些服务**：可能限制代理IP访问
- 🚫 **游戏延迟**：可能影响在线游戏

### 4. 紧急恢复
如果需要临时恢复正常模式：
1. 启用"绕过中国大陆"功能
2. 在NameServer中添加国内DNS
3. 修改FINAL规则为直连

## 🎖️ 完全隐匿优势

1. **绝对隐私**：ISP无法知道你访问的任何网站
2. **防DNS泄露**：连DNS查询都查不到
3. **统一出口**：所有流量都从代理IP出去
4. **防审查**：所有流量都被加密

这样设置后，你就实现了真正的完全隐匿！所有流量都走代理，DNS完全不泄露。
